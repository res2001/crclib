/*================================================================================================*
 * Контрольные суммы CRC-4, CRC-8, CRC-16 и CRC-32 с повышенной скоростью вычислений
 *================================================================================================*/

#include "fast_crc.h"

/*================================================================================================*/
#if (FASTCRC_CRC4_ADD4 || FASTCRC_CRC4_ADD8 || FASTCRC_CRC4_BLOCK8) && FASTCRC_CRC4_USE_TABLE
FASTCRC_CONST_TAB FASTCRC_U8_TYPE g_fastcrc_crc4_table[16] =
    {
    0x0, 0x3, 0x6, 0x5, 0xC, 0xF, 0xA, 0x9, 0xB, 0x8, 0xD, 0xE, 0x7, 0x4, 0x1, 0x2
    };
#endif

#if (FASTCRC_CRC8_ADD8 || FASTCRC_CRC8_BLOCK8) && FASTCRC_CRC8_USE_TABLE
FASTCRC_CONST_TAB FASTCRC_U8_TYPE g_fastcrc_crc8_table[256] =
    {
    0x00, 0x8C, 0x94, 0x18, 0xA4, 0x28, 0x30, 0xBC, 0xC4, 0x48, 0x50, 0xDC, 0x60, 0xEC, 0xF4, 0x78,
    0x04, 0x88, 0x90, 0x1C, 0xA0, 0x2C, 0x34, 0xB8, 0xC0, 0x4C, 0x54, 0xD8, 0x64, 0xE8, 0xF0, 0x7C,
    0x08, 0x84, 0x9C, 0x10, 0xAC, 0x20, 0x38, 0xB4, 0xCC, 0x40, 0x58, 0xD4, 0x68, 0xE4, 0xFC, 0x70,
    0x0C, 0x80, 0x98, 0x14, 0xA8, 0x24, 0x3C, 0xB0, 0xC8, 0x44, 0x5C, 0xD0, 0x6C, 0xE0, 0xF8, 0x74,
    0x10, 0x9C, 0x84, 0x08, 0xB4, 0x38, 0x20, 0xAC, 0xD4, 0x58, 0x40, 0xCC, 0x70, 0xFC, 0xE4, 0x68,
    0x14, 0x98, 0x80, 0x0C, 0xB0, 0x3C, 0x24, 0xA8, 0xD0, 0x5C, 0x44, 0xC8, 0x74, 0xF8, 0xE0, 0x6C,
    0x18, 0x94, 0x8C, 0x00, 0xBC, 0x30, 0x28, 0xA4, 0xDC, 0x50, 0x48, 0xC4, 0x78, 0xF4, 0xEC, 0x60,
    0x1C, 0x90, 0x88, 0x04, 0xB8, 0x34, 0x2C, 0xA0, 0xD8, 0x54, 0x4C, 0xC0, 0x7C, 0xF0, 0xE8, 0x64,
    0x20, 0xAC, 0xB4, 0x38, 0x84, 0x08, 0x10, 0x9C, 0xE4, 0x68, 0x70, 0xFC, 0x40, 0xCC, 0xD4, 0x58,
    0x24, 0xA8, 0xB0, 0x3C, 0x80, 0x0C, 0x14, 0x98, 0xE0, 0x6C, 0x74, 0xF8, 0x44, 0xC8, 0xD0, 0x5C,
    0x28, 0xA4, 0xBC, 0x30, 0x8C, 0x00, 0x18, 0x94, 0xEC, 0x60, 0x78, 0xF4, 0x48, 0xC4, 0xDC, 0x50,
    0x2C, 0xA0, 0xB8, 0x34, 0x88, 0x04, 0x1C, 0x90, 0xE8, 0x64, 0x7C, 0xF0, 0x4C, 0xC0, 0xD8, 0x54,
    0x30, 0xBC, 0xA4, 0x28, 0x94, 0x18, 0x00, 0x8C, 0xF4, 0x78, 0x60, 0xEC, 0x50, 0xDC, 0xC4, 0x48,
    0x34, 0xB8, 0xA0, 0x2C, 0x90, 0x1C, 0x04, 0x88, 0xF0, 0x7C, 0x64, 0xE8, 0x54, 0xD8, 0xC0, 0x4C,
    0x38, 0xB4, 0xAC, 0x20, 0x9C, 0x10, 0x08, 0x84, 0xFC, 0x70, 0x68, 0xE4, 0x58, 0xD4, 0xCC, 0x40,
    0x3C, 0xB0, 0xA8, 0x24, 0x98, 0x14, 0x0C, 0x80, 0xF8, 0x74, 0x6C, 0xE0, 0x5C, 0xD0, 0xC8, 0x44
    };
#endif

#if (FASTCRC_CRC8DS_ADD8 || FASTCRC_CRC8DS_BLOCK8) && FASTCRC_CRC8DS_USE_TABLE
FASTCRC_CONST_TAB FASTCRC_U8_TYPE g_fastcrc_crc8ds_table[256] =
    {
    0x00, 0x5E, 0xBC, 0xE2, 0x61, 0x3F, 0xDD, 0x83, 0xC2, 0x9C, 0x7E, 0x20, 0xA3, 0xFD, 0x1F, 0x41,
    0x9D, 0xC3, 0x21, 0x7F, 0xFC, 0xA2, 0x40, 0x1E, 0x5F, 0x01, 0xE3, 0xBD, 0x3E, 0x60, 0x82, 0xDC,
    0x23, 0x7D, 0x9F, 0xC1, 0x42, 0x1C, 0xFE, 0xA0, 0xE1, 0xBF, 0x5D, 0x03, 0x80, 0xDE, 0x3C, 0x62,
    0xBE, 0xE0, 0x02, 0x5C, 0xDF, 0x81, 0x63, 0x3D, 0x7C, 0x22, 0xC0, 0x9E, 0x1D, 0x43, 0xA1, 0xFF,
    0x46, 0x18, 0xFA, 0xA4, 0x27, 0x79, 0x9B, 0xC5, 0x84, 0xDA, 0x38, 0x66, 0xE5, 0xBB, 0x59, 0x07,
    0xDB, 0x85, 0x67, 0x39, 0xBA, 0xE4, 0x06, 0x58, 0x19, 0x47, 0xA5, 0xFB, 0x78, 0x26, 0xC4, 0x9A,
    0x65, 0x3B, 0xD9, 0x87, 0x04, 0x5A, 0xB8, 0xE6, 0xA7, 0xF9, 0x1B, 0x45, 0xC6, 0x98, 0x7A, 0x24,
    0xF8, 0xA6, 0x44, 0x1A, 0x99, 0xC7, 0x25, 0x7B, 0x3A, 0x64, 0x86, 0xD8, 0x5B, 0x05, 0xE7, 0xB9,
    0x8C, 0xD2, 0x30, 0x6E, 0xED, 0xB3, 0x51, 0x0F, 0x4E, 0x10, 0xF2, 0xAC, 0x2F, 0x71, 0x93, 0xCD,
    0x11, 0x4F, 0xAD, 0xF3, 0x70, 0x2E, 0xCC, 0x92, 0xD3, 0x8D, 0x6F, 0x31, 0xB2, 0xEC, 0x0E, 0x50,
    0xAF, 0xF1, 0x13, 0x4D, 0xCE, 0x90, 0x72, 0x2C, 0x6D, 0x33, 0xD1, 0x8F, 0x0C, 0x52, 0xB0, 0xEE,
    0x32, 0x6C, 0x8E, 0xD0, 0x53, 0x0D, 0xEF, 0xB1, 0xF0, 0xAE, 0x4C, 0x12, 0x91, 0xCF, 0x2D, 0x73,
    0xCA, 0x94, 0x76, 0x28, 0xAB, 0xF5, 0x17, 0x49, 0x08, 0x56, 0xB4, 0xEA, 0x69, 0x37, 0xD5, 0x8B,
    0x57, 0x09, 0xEB, 0xB5, 0x36, 0x68, 0x8A, 0xD4, 0x95, 0xCB, 0x29, 0x77, 0xF4, 0xAA, 0x48, 0x16,
    0xE9, 0xB7, 0x55, 0x0B, 0x88, 0xD6, 0x34, 0x6A, 0x2B, 0x75, 0x97, 0xC9, 0x4A, 0x14, 0xF6, 0xA8,
    0x74, 0x2A, 0xC8, 0x96, 0x15, 0x4B, 0xA9, 0xF7, 0xB6, 0xE8, 0x0A, 0x54, 0xD7, 0x89, 0x6B, 0x35
    };
#endif

#if (FASTCRC_CRC16_ADD8 || FASTCRC_CRC16_BLOCK8) && FASTCRC_CRC16_USE_TABLE
FASTCRC_CONST_TAB FASTCRC_U16_TYPE g_fastcrc_crc16_table[256] =
    {
    0x0000, 0x1021, 0x2042, 0x3063, 0x4084, 0x50A5, 0x60C6, 0x70E7,
    0x8108, 0x9129, 0xA14A, 0xB16B, 0xC18C, 0xD1AD, 0xE1CE, 0xF1EF,
    0x1231, 0x0210, 0x3273, 0x2252, 0x52B5, 0x4294, 0x72F7, 0x62D6,
    0x9339, 0x8318, 0xB37B, 0xA35A, 0xD3BD, 0xC39C, 0xF3FF, 0xE3DE,
    0x2462, 0x3443, 0x0420, 0x1401, 0x64E6, 0x74C7, 0x44A4, 0x5485,
    0xA56A, 0xB54B, 0x8528, 0x9509, 0xE5EE, 0xF5CF, 0xC5AC, 0xD58D,
    0x3653, 0x2672, 0x1611, 0x0630, 0x76D7, 0x66F6, 0x5695, 0x46B4,
    0xB75B, 0xA77A, 0x9719, 0x8738, 0xF7DF, 0xE7FE, 0xD79D, 0xC7BC,
    0x48C4, 0x58E5, 0x6886, 0x78A7, 0x0840, 0x1861, 0x2802, 0x3823,
    0xC9CC, 0xD9ED, 0xE98E, 0xF9AF, 0x8948, 0x9969, 0xA90A, 0xB92B,
    0x5AF5, 0x4AD4, 0x7AB7, 0x6A96, 0x1A71, 0x0A50, 0x3A33, 0x2A12,
    0xDBFD, 0xCBDC, 0xFBBF, 0xEB9E, 0x9B79, 0x8B58, 0xBB3B, 0xAB1A,
    0x6CA6, 0x7C87, 0x4CE4, 0x5CC5, 0x2C22, 0x3C03, 0x0C60, 0x1C41,
    0xEDAE, 0xFD8F, 0xCDEC, 0xDDCD, 0xAD2A, 0xBD0B, 0x8D68, 0x9D49,
    0x7E97, 0x6EB6, 0x5ED5, 0x4EF4, 0x3E13, 0x2E32, 0x1E51, 0x0E70,
    0xFF9F, 0xEFBE, 0xDFDD, 0xCFFC, 0xBF1B, 0xAF3A, 0x9F59, 0x8F78,
    0x9188, 0x81A9, 0xB1CA, 0xA1EB, 0xD10C, 0xC12D, 0xF14E, 0xE16F,
    0x1080, 0x00A1, 0x30C2, 0x20E3, 0x5004, 0x4025, 0x7046, 0x6067,
    0x83B9, 0x9398, 0xA3FB, 0xB3DA, 0xC33D, 0xD31C, 0xE37F, 0xF35E,
    0x02B1, 0x1290, 0x22F3, 0x32D2, 0x4235, 0x5214, 0x6277, 0x7256,
    0xB5EA, 0xA5CB, 0x95A8, 0x8589, 0xF56E, 0xE54F, 0xD52C, 0xC50D,
    0x34E2, 0x24C3, 0x14A0, 0x0481, 0x7466, 0x6447, 0x5424, 0x4405,
    0xA7DB, 0xB7FA, 0x8799, 0x97B8, 0xE75F, 0xF77E, 0xC71D, 0xD73C,
    0x26D3, 0x36F2, 0x0691, 0x16B0, 0x6657, 0x7676, 0x4615, 0x5634,
    0xD94C, 0xC96D, 0xF90E, 0xE92F, 0x99C8, 0x89E9, 0xB98A, 0xA9AB,
    0x5844, 0x4865, 0x7806, 0x6827, 0x18C0, 0x08E1, 0x3882, 0x28A3,
    0xCB7D, 0xDB5C, 0xEB3F, 0xFB1E, 0x8BF9, 0x9BD8, 0xABBB, 0xBB9A,
    0x4A75, 0x5A54, 0x6A37, 0x7A16, 0x0AF1, 0x1AD0, 0x2AB3, 0x3A92,
    0xFD2E, 0xED0F, 0xDD6C, 0xCD4D, 0xBDAA, 0xAD8B, 0x9DE8, 0x8DC9,
    0x7C26, 0x6C07, 0x5C64, 0x4C45, 0x3CA2, 0x2C83, 0x1CE0, 0x0CC1,
    0xEF1F, 0xFF3E, 0xCF5D, 0xDF7C, 0xAF9B, 0xBFBA, 0x8FD9, 0x9FF8,
    0x6E17, 0x7E36, 0x4E55, 0x5E74, 0x2E93, 0x3EB2, 0x0ED1, 0x1EF0
    };
#endif

#if (FASTCRC_CRC16MB_ADD8 || FASTCRC_CRC16MB_BLOCK8) && FASTCRC_CRC16MB_USE_TABLE
FASTCRC_CONST_TAB FASTCRC_U16_TYPE g_fastcrc_crc16mb_table[256] =
    {
    0x0000, 0xC0C1, 0xC181, 0x0140, 0xC301, 0x03C0, 0x0280, 0xC241,
    0xC601, 0x06C0, 0x0780, 0xC741, 0x0500, 0xC5C1, 0xC481, 0x0440,
    0xCC01, 0x0CC0, 0x0D80, 0xCD41, 0x0F00, 0xCFC1, 0xCE81, 0x0E40,
    0x0A00, 0xCAC1, 0xCB81, 0x0B40, 0xC901, 0x09C0, 0x0880, 0xC841,
    0xD801, 0x18C0, 0x1980, 0xD941, 0x1B00, 0xDBC1, 0xDA81, 0x1A40,
    0x1E00, 0xDEC1, 0xDF81, 0x1F40, 0xDD01, 0x1DC0, 0x1C80, 0xDC41,
    0x1400, 0xD4C1, 0xD581, 0x1540, 0xD701, 0x17C0, 0x1680, 0xD641,
    0xD201, 0x12C0, 0x1380, 0xD341, 0x1100, 0xD1C1, 0xD081, 0x1040,
    0xF001, 0x30C0, 0x3180, 0xF141, 0x3300, 0xF3C1, 0xF281, 0x3240,
    0x3600, 0xF6C1, 0xF781, 0x3740, 0xF501, 0x35C0, 0x3480, 0xF441,
    0x3C00, 0xFCC1, 0xFD81, 0x3D40, 0xFF01, 0x3FC0, 0x3E80, 0xFE41,
    0xFA01, 0x3AC0, 0x3B80, 0xFB41, 0x3900, 0xF9C1, 0xF881, 0x3840,
    0x2800, 0xE8C1, 0xE981, 0x2940, 0xEB01, 0x2BC0, 0x2A80, 0xEA41,
    0xEE01, 0x2EC0, 0x2F80, 0xEF41, 0x2D00, 0xEDC1, 0xEC81, 0x2C40,
    0xE401, 0x24C0, 0x2580, 0xE541, 0x2700, 0xE7C1, 0xE681, 0x2640,
    0x2200, 0xE2C1, 0xE381, 0x2340, 0xE101, 0x21C0, 0x2080, 0xE041,
    0xA001, 0x60C0, 0x6180, 0xA141, 0x6300, 0xA3C1, 0xA281, 0x6240,
    0x6600, 0xA6C1, 0xA781, 0x6740, 0xA501, 0x65C0, 0x6480, 0xA441,
    0x6C00, 0xACC1, 0xAD81, 0x6D40, 0xAF01, 0x6FC0, 0x6E80, 0xAE41,
    0xAA01, 0x6AC0, 0x6B80, 0xAB41, 0x6900, 0xA9C1, 0xA881, 0x6840,
    0x7800, 0xB8C1, 0xB981, 0x7940, 0xBB01, 0x7BC0, 0x7A80, 0xBA41,
    0xBE01, 0x7EC0, 0x7F80, 0xBF41, 0x7D00, 0xBDC1, 0xBC81, 0x7C40,
    0xB401, 0x74C0, 0x7580, 0xB541, 0x7700, 0xB7C1, 0xB681, 0x7640,
    0x7200, 0xB2C1, 0xB381, 0x7340, 0xB101, 0x71C0, 0x7080, 0xB041,
    0x5000, 0x90C1, 0x9181, 0x5140, 0x9301, 0x53C0, 0x5280, 0x9241,
    0x9601, 0x56C0, 0x5780, 0x9741, 0x5500, 0x95C1, 0x9481, 0x5440,
    0x9C01, 0x5CC0, 0x5D80, 0x9D41, 0x5F00, 0x9FC1, 0x9E81, 0x5E40,
    0x5A00, 0x9AC1, 0x9B81, 0x5B40, 0x9901, 0x59C0, 0x5880, 0x9841,
    0x8801, 0x48C0, 0x4980, 0x8941, 0x4B00, 0x8BC1, 0x8A81, 0x4A40,
    0x4E00, 0x8EC1, 0x8F81, 0x4F40, 0x8D01, 0x4DC0, 0x4C80, 0x8C41,
    0x4400, 0x84C1, 0x8581, 0x4540, 0x8701, 0x47C0, 0x4680, 0x8641,
    0x8201, 0x42C0, 0x4380, 0x8341, 0x4100, 0x81C1, 0x8081, 0x4040
    };
#endif

#if FASTCRC_CRC32_BLOCK8
static FASTCRC_CONST_TAB FASTCRC_U32_TYPE f_crc32_table[256] =
    {
    0x00000000UL, 0x77073096UL, 0xEE0E612CUL, 0x990951BAUL, 0x076DC419UL,
    0x706AF48FUL, 0xE963A535UL, 0x9E6495A3UL, 0x0EDB8832UL, 0x79DCB8A4UL,
    0xE0D5E91EUL, 0x97D2D988UL, 0x09B64C2BUL, 0x7EB17CBDUL, 0xE7B82D07UL,
    0x90BF1D91UL, 0x1DB71064UL, 0x6AB020F2UL, 0xF3B97148UL, 0x84BE41DEUL,
    0x1ADAD47DUL, 0x6DDDE4EBUL, 0xF4D4B551UL, 0x83D385C7UL, 0x136C9856UL,
    0x646BA8C0UL, 0xFD62F97AUL, 0x8A65C9ECUL, 0x14015C4FUL, 0x63066CD9UL,
    0xFA0F3D63UL, 0x8D080DF5UL, 0x3B6E20C8UL, 0x4C69105EUL, 0xD56041E4UL,
    0xA2677172UL, 0x3C03E4D1UL, 0x4B04D447UL, 0xD20D85FDUL, 0xA50AB56BUL,
    0x35B5A8FAUL, 0x42B2986CUL, 0xDBBBC9D6UL, 0xACBCF940UL, 0x32D86CE3UL,
    0x45DF5C75UL, 0xDCD60DCFUL, 0xABD13D59UL, 0x26D930ACUL, 0x51DE003AUL,
    0xC8D75180UL, 0xBFD06116UL, 0x21B4F4B5UL, 0x56B3C423UL, 0xCFBA9599UL,
    0xB8BDA50FUL, 0x2802B89EUL, 0x5F058808UL, 0xC60CD9B2UL, 0xB10BE924UL,
    0x2F6F7C87UL, 0x58684C11UL, 0xC1611DABUL, 0xB6662D3DUL, 0x76DC4190UL,
    0x01DB7106UL, 0x98D220BCUL, 0xEFD5102AUL, 0x71B18589UL, 0x06B6B51FUL,
    0x9FBFE4A5UL, 0xE8B8D433UL, 0x7807C9A2UL, 0x0F00F934UL, 0x9609A88EUL,
    0xE10E9818UL, 0x7F6A0DBBUL, 0x086D3D2DUL, 0x91646C97UL, 0xE6635C01UL,
    0x6B6B51F4UL, 0x1C6C6162UL, 0x856530D8UL, 0xF262004EUL, 0x6C0695EDUL,
    0x1B01A57BUL, 0x8208F4C1UL, 0xF50FC457UL, 0x65B0D9C6UL, 0x12B7E950UL,
    0x8BBEB8EAUL, 0xFCB9887CUL, 0x62DD1DDFUL, 0x15DA2D49UL, 0x8CD37CF3UL,
    0xFBD44C65UL, 0x4DB26158UL, 0x3AB551CEUL, 0xA3BC0074UL, 0xD4BB30E2UL,
    0x4ADFA541UL, 0x3DD895D7UL, 0xA4D1C46DUL, 0xD3D6F4FBUL, 0x4369E96AUL,
    0x346ED9FCUL, 0xAD678846UL, 0xDA60B8D0UL, 0x44042D73UL, 0x33031DE5UL,
    0xAA0A4C5FUL, 0xDD0D7CC9UL, 0x5005713CUL, 0x270241AAUL, 0xBE0B1010UL,
    0xC90C2086UL, 0x5768B525UL, 0x206F85B3UL, 0xB966D409UL, 0xCE61E49FUL,
    0x5EDEF90EUL, 0x29D9C998UL, 0xB0D09822UL, 0xC7D7A8B4UL, 0x59B33D17UL,
    0x2EB40D81UL, 0xB7BD5C3BUL, 0xC0BA6CADUL, 0xEDB88320UL, 0x9ABFB3B6UL,
    0x03B6E20CUL, 0x74B1D29AUL, 0xEAD54739UL, 0x9DD277AFUL, 0x04DB2615UL,
    0x73DC1683UL, 0xE3630B12UL, 0x94643B84UL, 0x0D6D6A3EUL, 0x7A6A5AA8UL,
    0xE40ECF0BUL, 0x9309FF9DUL, 0x0A00AE27UL, 0x7D079EB1UL, 0xF00F9344UL,
    0x8708A3D2UL, 0x1E01F268UL, 0x6906C2FEUL, 0xF762575DUL, 0x806567CBUL,
    0x196C3671UL, 0x6E6B06E7UL, 0xFED41B76UL, 0x89D32BE0UL, 0x10DA7A5AUL,
    0x67DD4ACCUL, 0xF9B9DF6FUL, 0x8EBEEFF9UL, 0x17B7BE43UL, 0x60B08ED5UL,
    0xD6D6A3E8UL, 0xA1D1937EUL, 0x38D8C2C4UL, 0x4FDFF252UL, 0xD1BB67F1UL,
    0xA6BC5767UL, 0x3FB506DDUL, 0x48B2364BUL, 0xD80D2BDAUL, 0xAF0A1B4CUL,
    0x36034AF6UL, 0x41047A60UL, 0xDF60EFC3UL, 0xA867DF55UL, 0x316E8EEFUL,
    0x4669BE79UL, 0xCB61B38CUL, 0xBC66831AUL, 0x256FD2A0UL, 0x5268E236UL,
    0xCC0C7795UL, 0xBB0B4703UL, 0x220216B9UL, 0x5505262FUL, 0xC5BA3BBEUL,
    0xB2BD0B28UL, 0x2BB45A92UL, 0x5CB36A04UL, 0xC2D7FFA7UL, 0xB5D0CF31UL,
    0x2CD99E8BUL, 0x5BDEAE1DUL, 0x9B64C2B0UL, 0xEC63F226UL, 0x756AA39CUL,
    0x026D930AUL, 0x9C0906A9UL, 0xEB0E363FUL, 0x72076785UL, 0x05005713UL,
    0x95BF4A82UL, 0xE2B87A14UL, 0x7BB12BAEUL, 0x0CB61B38UL, 0x92D28E9BUL,
    0xE5D5BE0DUL, 0x7CDCEFB7UL, 0x0BDBDF21UL, 0x86D3D2D4UL, 0xF1D4E242UL,
    0x68DDB3F8UL, 0x1FDA836EUL, 0x81BE16CDUL, 0xF6B9265BUL, 0x6FB077E1UL,
    0x18B74777UL, 0x88085AE6UL, 0xFF0F6A70UL, 0x66063BCAUL, 0x11010B5CUL,
    0x8F659EFFUL, 0xF862AE69UL, 0x616BFFD3UL, 0x166CCF45UL, 0xA00AE278UL,
    0xD70DD2EEUL, 0x4E048354UL, 0x3903B3C2UL, 0xA7672661UL, 0xD06016F7UL,
    0x4969474DUL, 0x3E6E77DBUL, 0xAED16A4AUL, 0xD9D65ADCUL, 0x40DF0B66UL,
    0x37D83BF0UL, 0xA9BCAE53UL, 0xDEBB9EC5UL, 0x47B2CF7FUL, 0x30B5FFE9UL,
    0xBDBDF21CUL, 0xCABAC28AUL, 0x53B39330UL, 0x24B4A3A6UL, 0xBAD03605UL,
    0xCDD70693UL, 0x54DE5729UL, 0x23D967BFUL, 0xB3667A2EUL, 0xC4614AB8UL,
    0x5D681B02UL, 0x2A6F2B94UL, 0xB40BBE37UL, 0xC30C8EA1UL, 0x5A05DF1BUL,
    0x2D02EF8DUL
    };
#endif
/*================================================================================================*/

/*================================================================================================*/
/* Вычисление CRC4-ITU (полином 0x3, сдвиг влево) */
/*================================================================================================*/

#if FASTCRC_CRC4_ADD4 == 1
/*------------------------------------------------------------------------------------------------*/
FASTCRC_U8_TYPE CRC4_Add4           /* Добавление ниббла */
    (
    FASTCRC_U8_TYPE crc,            /* (вх)  - начальное значение */
    FASTCRC_U8_TYPE data            /* (вх)  - данные */
    )
    {
    FASTCRC_CRC4_UPDATE4(crc, data);
    return crc;
    }
/*------------------------------------------------------------------------------------------------*/
#endif

#if FASTCRC_CRC4_ADD8 == 1
/*------------------------------------------------------------------------------------------------*/
FASTCRC_U8_TYPE CRC4_Add8           /* Добавление байта */
    (
    FASTCRC_U8_TYPE crc,            /* (вх)  - начальное значение */
    FASTCRC_U8_TYPE data            /* (вх)  - данные */
    )
    {
    FASTCRC_CRC4_UPDATE8(crc, data);
    return crc;
    }
/*------------------------------------------------------------------------------------------------*/
#endif

#if FASTCRC_CRC4_BLOCK8
/*------------------------------------------------------------------------------------------------*/
FASTCRC_U8_TYPE CRC4_Block8         /* Вычисление CRC4 блока байтов */
    (
    FASTCRC_U8_TYPE crc,            /* (вх)  - начальное значение */
    const FASTCRC_U8_TYPE* pdata,   /* (вх)  - данные */
    FASTCRC_SIZE_TYPE num_bytes     /* (вх)  - размер данных */
    )
    {
    if (pdata)
        {
        while (num_bytes--)
            {
            FASTCRC_CRC4_UPDATE8(crc, *pdata++);
            }
        }
    return crc;
    }
/*------------------------------------------------------------------------------------------------*/
#endif

/*================================================================================================*/
/* Вычисление CRC8 (совместимая со старой библиотекой, полином 0x8C от Dallas, но сдвиг влево) */
/* Эта CRC плохая, только 6 значащих бит - полином неподходящий */
/*================================================================================================*/

#if FASTCRC_CRC8_ADD8 == 1
/*------------------------------------------------------------------------------------------------*/
FASTCRC_U8_TYPE CRC8_Add8           /* Добавление байта */
    (
    FASTCRC_U8_TYPE crc,            /* (вх)  - начальное значение */
    FASTCRC_U8_TYPE data            /* (вх)  - данные */
    )
    {
    FASTCRC_CRC8_UPDATE8(crc, data);
    return crc;
    }
/*------------------------------------------------------------------------------------------------*/
#endif

#if FASTCRC_CRC8_BLOCK8
/*------------------------------------------------------------------------------------------------*/
FASTCRC_U8_TYPE CRC8_Block8         /* Вычисление CRC8 блока байтов */
    (
    FASTCRC_U8_TYPE crc,            /* (вх)  - начальное значение */
    const FASTCRC_U8_TYPE* pdata,   /* (вх)  - данные */
    FASTCRC_SIZE_TYPE num_bytes     /* (вх)  - размер данных */
    )
    {
    if (pdata)
        {
        while (num_bytes--)
            {
            FASTCRC_CRC8_UPDATE8(crc, *pdata++);
            }
        }
    return crc;
    }
/*------------------------------------------------------------------------------------------------*/
#endif

/*================================================================================================*/
/* Вычисление CRC8 (DALLAS, 0x8C, сдвиг вправо) */
/*================================================================================================*/

#if FASTCRC_CRC8DS_ADD8 == 1
/*------------------------------------------------------------------------------------------------*/
FASTCRC_U8_TYPE CRC8DS_Add8         /* Добавление байта */
    (
    FASTCRC_U8_TYPE crc,            /* (вх)  - начальное значение */
    FASTCRC_U8_TYPE data            /* (вх)  - данные */
    )
    {
    FASTCRC_CRC8DS_UPDATE8(crc, data);
    return crc;
    }
/*------------------------------------------------------------------------------------------------*/
#endif

#if FASTCRC_CRC8DS_BLOCK8
/*------------------------------------------------------------------------------------------------*/
FASTCRC_U8_TYPE CRC8DS_Block8       /* Вычисление CRC8DS блока байтов */
    (
    FASTCRC_U8_TYPE crc,            /* (вх)  - начальное значение */
    const FASTCRC_U8_TYPE* pdata,   /* (вх)  - данные */
    FASTCRC_SIZE_TYPE num_bytes     /* (вх)  - размер данных */
    )
    {
    if (pdata)
        {
        while (num_bytes--)
            {
            FASTCRC_CRC8DS_UPDATE8(crc, *pdata++);
            }
        }
    return crc;
    }
/*------------------------------------------------------------------------------------------------*/
#endif

/*================================================================================================*/
/* Вычисление CRC16 (CCITT, 0x1021, сдвиг влево) */
/*================================================================================================*/

#if FASTCRC_CRC16_ADD8 == 1
/*------------------------------------------------------------------------------------------------*/
FASTCRC_U16_TYPE CRC16_Add8         /* Добавление байта */
    (
    FASTCRC_U16_TYPE crc,           /* (вх)  - начальное значение */
    FASTCRC_U8_TYPE data            /* (вх)  - данные */
    )
    {
    FASTCRC_CRC16_UPDATE8(crc, data);
    return crc;
    }
/*------------------------------------------------------------------------------------------------*/
#endif

#if FASTCRC_CRC16_ADD16 == 1
/*------------------------------------------------------------------------------------------------*/
FASTCRC_U16_TYPE CRC16_Add16        /* Добавление 16-битного слова (младший байт первым) */
    (
    FASTCRC_U16_TYPE crc,           /* (вх)  - начальное значение */
    FASTCRC_U16_TYPE data           /* (вх)  - данные */
    )
    {
    FASTCRC_CRC16_UPDATE16(crc, data);
    return crc;
    }
/*------------------------------------------------------------------------------------------------*/
#endif

#if FASTCRC_CRC16_BLOCK8
/*------------------------------------------------------------------------------------------------*/
FASTCRC_U16_TYPE CRC16_Block8       /* Вычисление CRC16 блока байтов */
    (
    FASTCRC_U16_TYPE crc,           /* (вх)  - начальное значение */
    const FASTCRC_U8_TYPE* pdata,   /* (вх)  - данные */
    FASTCRC_SIZE_TYPE num_bytes     /* (вх)  - размер данных */
    )
    {
    if (pdata)
        {
        while (num_bytes--)
            {
            FASTCRC_CRC16_UPDATE8(crc, *pdata++);
            }
        }
    return crc;
    }
/*------------------------------------------------------------------------------------------------*/
#endif

#if FASTCRC_CRC16_BLOCK16
/*------------------------------------------------------------------------------------------------*/
FASTCRC_U16_TYPE CRC16_Block16      /* Вычисление CRC16 блока 16-битных слов */
    (
    FASTCRC_U16_TYPE crc,           /* (вх)  - начальное значение */
    const FASTCRC_U16_TYPE* pdata,  /* (вх)  - данные */
    FASTCRC_SIZE_TYPE num_words     /* (вх)  - размер данных */
    )
    {
    if (pdata)
        {
        while (num_words--)
            {
            FASTCRC_CRC16_UPDATE16(crc, *pdata++);
            }
        }
    return crc;
    }
/*------------------------------------------------------------------------------------------------*/
#endif

/*================================================================================================*/
/* Вычисление CRC16MB (MODBUS, 0xA001, сдвиг вправо) */
/*================================================================================================*/

#if FASTCRC_CRC16MB_ADD8 == 1
/*------------------------------------------------------------------------------------------------*/
FASTCRC_U16_TYPE CRC16MB_Add8       /* Добавление байта */
    (
    FASTCRC_U16_TYPE crc,           /* (вх)  - начальное значение */
    FASTCRC_U8_TYPE data            /* (вх)  - данные */
    )
    {
    FASTCRC_CRC16MB_UPDATE8(crc, data);
    return crc;
    }
/*------------------------------------------------------------------------------------------------*/
#endif

#if FASTCRC_CRC16MB_ADD16 == 1
/*------------------------------------------------------------------------------------------------*/
FASTCRC_U16_TYPE CRC16MB_Add16      /* Добавление 16-битного слова (младший байт первым) */
    (
    FASTCRC_U16_TYPE crc,           /* (вх)  - начальное значение */
    FASTCRC_U16_TYPE data           /* (вх)  - данные */
    )
    {
    FASTCRC_CRC16MB_UPDATE16(crc, data);
    return crc;
    }
/*------------------------------------------------------------------------------------------------*/
#endif

#if FASTCRC_CRC16MB_BLOCK8
/*------------------------------------------------------------------------------------------------*/
FASTCRC_U16_TYPE CRC16MB_Block8     /* Вычисление CRC16MB блока байтов */
    (
    FASTCRC_U16_TYPE crc,           /* (вх)  - начальное значение */
    const FASTCRC_U8_TYPE* pdata,   /* (вх)  - данные */
    FASTCRC_SIZE_TYPE num_bytes     /* (вх)  - размер данных */
    )
    {
    if (pdata)
        {
        while (num_bytes--)
            {
            FASTCRC_CRC16MB_UPDATE8(crc, *pdata++);
            }
        }
    return crc;
    }
/*------------------------------------------------------------------------------------------------*/
#endif

#if FASTCRC_CRC16MB_BLOCK16
/*------------------------------------------------------------------------------------------------*/
FASTCRC_U16_TYPE CRC16MB_Block16    /* Вычисление CRC16MB блока 16-битных слов */
    (
    FASTCRC_U16_TYPE crc,           /* (вх)  - начальное значение */
    const FASTCRC_U16_TYPE* pdata,  /* (вх)  - данные */
    FASTCRC_SIZE_TYPE num_words     /* (вх)  - размер данных */
    )
    {
    if (pdata)
        {
        while (num_words--)
            {
            FASTCRC_CRC16MB_UPDATE16(crc, *pdata++);
            }
        }
    return crc;
    }
/*------------------------------------------------------------------------------------------------*/
#endif

/*================================================================================================*/
/* Вычисление CRC32 (CCITT) */
/*================================================================================================*/

#if FASTCRC_CRC32_BLOCK8
/*------------------------------------------------------------------------------------------------*/
/* crc32 -- compute the CRC-32 of a data stream
 * Copyright (C) 1995-2005 Mark Adler
 *
 * THIS VERSION HAS BEEN MODIFIED:
 *  No BYFOUR code (fast, but requires 8 tables)
 *  No dynamic table generation
 *  CRC concatenation function removed
 *  Code reformatted for cosmetic uniformity
 */
FASTCRC_U32_TYPE CRC32_Block8       /* Вычисление CRC32 блока байтов */
    (
    FASTCRC_U32_TYPE crc,           /* (вх)  - начальное значение (при первом блоке 0) */
    const FASTCRC_U8_TYPE* pdata,   /* (вх)  - данные */
    FASTCRC_SIZE_TYPE num_bytes     /* (вх)  - размер данных */
    )
    {
#define DO1 crc = f_crc32_table[(crc ^ (*pdata++)) & 0xFF] ^ (crc >> 8)
    if (!pdata) return crc;
    crc ^= 0xFFFFFFFFUL;
    while (num_bytes >= 8)
        {
        DO1; DO1; DO1; DO1;
        DO1; DO1; DO1; DO1;
        num_bytes = (FASTCRC_SIZE_TYPE)(num_bytes - 8);
        }
    if (num_bytes) do
        {
        DO1;
        }
    while (--num_bytes);
    return crc ^ 0xFFFFFFFFUL;
#undef DO1
    }
/*------------------------------------------------------------------------------------------------*/
#endif
/*================================================================================================*/
